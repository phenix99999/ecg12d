{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import axios from'axios';import base64 from'react-native-base64';var data;var error;var records=[];var formatedData=[];export function getFmResultSet(data){return data.children[0].children;}export function getError(fmResultSet){for(var i=0;i<fmResultSet.length;i++){if(fmResultSet[i].name==\"error\"){return fmResultSet[i].attributes.code;}}return false;}export function getRecords(fmResultSet){for(var i=0;i<fmResultSet.length;i++){if(fmResultSet[i].name==\"resultset\"){return fmResultSet[i].children;}}return false;}export function formatData(records){var formatedDataTemp=[];for(var indexRecord=0;indexRecord<records.length;indexRecord++){for(var indexField=0;indexField<records[indexRecord].children.length;indexField++){if(indexField==0){formatedDataTemp[indexRecord]={};}formatedDataTemp[indexRecord][records[indexRecord].children[indexField].attributes.name]=records[indexRecord].children[indexField].children[0].value;formatedDataTemp[indexRecord]['record-id']=records[indexRecord]['attributes']['record-id'];}}return formatedDataTemp;}export function authentification(username,password,server,db,layout,query){var authHeader,data;return _regeneratorRuntime.async(function authentification$(_context){while(1){switch(_context.prev=_context.next){case 0:authHeader='Basic '+base64.encode(username+\":\"+password);_context.next=3;return _regeneratorRuntime.awrap(get(username,password,server,db,layout,query));case 3:data=_context.sent;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},null,null,null,Promise);}export function add(username,password,server,db,layout,query){var XMLParser,authHeader,url;return _regeneratorRuntime.async(function add$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:XMLParser=require('react-xml-parser');authHeader='Basic '+base64.encode(username+\":\"+password);url=\"https://\"+server+\"/fmi/xml/fmresultset.xml?-db=\"+db+\"&-lay=\"+layout+query+\"&-new\";_context2.next=5;return _regeneratorRuntime.awrap(axios.post(url,{},{headers:{'Authorization':authHeader}}).then(function(response){data=new XMLParser().parseFromString(response.data);return true;}).catch(function(error){console.log(\"ERROR IN ADDD\");alert(\"ERROR\");return false;}));case 5:case\"end\":return _context2.stop();}}},null,null,null,Promise);}export function execScript(username,password,server,db,layout,scriptName,scriptParam){var authHeader,XMLParser,url,errorAuth;return _regeneratorRuntime.async(function execScript$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:authHeader='Basic '+base64.encode(username+\":\"+password);XMLParser=require('react-xml-parser');url=\"https://\"+server+\"/fmi/xml/fmresultset.xml?-findall&-db=\"+db+\"&-lay=\"+layout+\"&-script=\"+scriptName+\"&-script.param=\"+scriptParam;console.log(url);errorAuth=false;_context3.next=7;return _regeneratorRuntime.awrap(axios.post(url,{},{headers:{'Authorization':authHeader}}).then(function(response){data=new XMLParser().parseFromString(response.data);}).catch(function(error){alert(\"ERROR\");errorAuth=true;}));case 7:case\"end\":return _context3.stop();}}},null,null,null,Promise);}export function edit(username,password,server,db,layout,recid,query){var XMLParser,authHeader,url;return _regeneratorRuntime.async(function edit$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:XMLParser=require('react-xml-parser');authHeader='Basic '+base64.encode(username+\":\"+password);url=\"https://\"+server+\"/fmi/xml/fmresultset.xml?-db=\"+db+\"&-lay=\"+layout+\"&-recid=\"+recid+query+\"&-edit\";console.log(url);_context4.next=6;return _regeneratorRuntime.awrap(axios.post(url,{},{headers:{'Authorization':authHeader}}).then(function(response){data=new XMLParser().parseFromString(response.data);return true;}).catch(function(error){alert(\"ERROR\");return false;}));case 6:case\"end\":return _context4.stop();}}},null,null,null,Promise);}export function get(username,password,server,db,layout){var query,authHeader,XMLParser,url,errorAuth,fmResultSet,error,records,dataFormated,_args5=arguments;return _regeneratorRuntime.async(function get$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:query=_args5.length>5&&_args5[5]!==undefined?_args5[5]:null;authHeader='Basic '+base64.encode(username+\":\"+password);XMLParser=require('react-xml-parser');url=\"https://\"+server+\"/fmi/xml/fmresultset.xml?-findall&-db=\"+db+\"&-lay=\"+layout;if(query){url=\"https://\"+server+\"/fmi/xml/fmresultset.xml?-find&-db=\"+db+\"&-lay=\"+layout+query;}console.log(url);errorAuth=false;_context5.next=9;return _regeneratorRuntime.awrap(axios.post(url,{},{headers:{'Authorization':authHeader}}).then(function(response){data=new XMLParser().parseFromString(response.data);}).catch(function(error){errorAuth=true;}));case 9:if(!errorAuth){_context5.next=11;break;}return _context5.abrupt(\"return\",-1);case 11:fmResultSet=getFmResultSet(data);error=getError(fmResultSet);records=getRecords(fmResultSet);dataFormated=formatData(records);return _context5.abrupt(\"return\",dataFormated);case 16:case\"end\":return _context5.stop();}}},null,null,null,Promise);}","map":{"version":3,"sources":["/Users/lyestamazouzt/Projects/CoffretsPrestige/src/utils/connectorFileMaker.ts"],"names":["axios","base64","data","error","records","formatedData","getFmResultSet","children","getError","fmResultSet","i","length","name","attributes","code","getRecords","formatData","formatedDataTemp","indexRecord","indexField","value","authentification","username","password","server","db","layout","query","authHeader","encode","get","add","XMLParser","require","url","post","headers","then","response","parseFromString","catch","console","log","alert","execScript","scriptName","scriptParam","errorAuth","edit","recid","dataFormated"],"mappings":"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","sourcesContent":["\nimport * as React from \"react\";\nimport axios from 'axios';\nimport base64 from 'react-native-base64';\n\nlet data;\nlet error;\nlet records = [];\nlet formatedData = [];\n\nexport function getFmResultSet(data) {\n    return data.children[0].children;\n}\n\nexport function getError(fmResultSet) {\n    for (let i = 0; i < fmResultSet.length; i++) {\n        if (fmResultSet[i].name == \"error\") {\n            return (fmResultSet[i].attributes.code);\n        }\n    }\n    return false;\n}\n\nexport function getRecords(fmResultSet) {\n    for (let i = 0; i < fmResultSet.length; i++) {\n\n        if (fmResultSet[i].name == \"resultset\") {\n            return fmResultSet[i].children;\n        }\n    }\n    return false;\n}\n\nexport function formatData(records) {\n    let formatedDataTemp = [];\n\n    for (let indexRecord = 0; indexRecord < records.length; indexRecord++) {\n        for (let indexField = 0; indexField < records[indexRecord].children.length; indexField++) {\n            if (indexField == 0) {\n                formatedDataTemp[indexRecord] = {};\n            }\n\n            formatedDataTemp[indexRecord][records[indexRecord].children[indexField].attributes.name] = records[indexRecord].children[indexField].children[0].value;\n\n            formatedDataTemp[indexRecord]['record-id'] = records[indexRecord]['attributes']['record-id'];\n\n        }\n    }\n\n    return formatedDataTemp;\n}\n\nexport async function authentification(username, password, server, db, layout, query) {\n    const authHeader = 'Basic ' + base64.encode(`${username}:${password}`);\n\n    let data = await get(username, password, server, db, layout, query);\n    return data;\n}\n\nexport async function add(username, password, server, db, layout, query) {\n    var XMLParser = require('react-xml-parser');\n    const authHeader = 'Basic ' + base64.encode(`${username}:${password}`);\n\n    // https://vhmsoft.com/fmi/xml/fmresultset.xml?-db=vhmsoft_Lyes&-lay=mobile_TEMPS&AM_PM=PM&-new\n    let url = \"https://\" + server + \"/fmi/xml/fmresultset.xml?-db=\" + db + \"&-lay=\" + layout + query + \"&-new\";\n\n    await axios.post(url, {}, {\n        headers: { 'Authorization': authHeader }\n    }).then(function (response) {\n        data = new XMLParser().parseFromString(response.data);\n\n        return true;\n    }).catch(function (error) {\n        console.log(\"ERROR IN ADDD\");\n        alert(\"ERROR\");\n        return false;\n    });\n\n}\n\n\nexport async function execScript(username, password, server, db, layout, scriptName, scriptParam) {\n    const authHeader = 'Basic ' + base64.encode(`${username}:${password}`);\n    var XMLParser = require('react-xml-parser');\n\n    let url = \"https://\" + server + \"/fmi/xml/fmresultset.xml?-findall&-db=\" + db + \"&-lay=\" + layout + \"&-script=\" + scriptName\n        + \"&-script.param=\" + scriptParam;\n\n    console.log(url);\n    let errorAuth = false;\n\n    await axios.post(url, {}, {\n        headers: { 'Authorization': authHeader }\n    }).then(function (response) {\n        data = new XMLParser().parseFromString(response.data);\n    }).catch(function (error) {\n        alert(\"ERROR\");\n        errorAuth = true;\n    });\n\n\n\n}\n\n\n\nexport async function edit(username, password, server, db, layout, recid, query) {\n    var XMLParser = require('react-xml-parser');\n    const authHeader = 'Basic ' + base64.encode(`${username}:${password}`);\n\n    // https://vhmsoft.com/fmi/xml/fmresultset.xml?-db=vhmsoft_Lyes&-lay=mobile_TEMPS&AM_PM=PM&-new\n    let url = \"https://\" + server + \"/fmi/xml/fmresultset.xml?-db=\" + db + \"&-lay=\" + layout + \"&-recid=\" + recid + query + \"&-edit\";\n\n    console.log(url);\n    await axios.post(url, {}, {\n        headers: { 'Authorization': authHeader }\n    }).then(function (response) {\n        data = new XMLParser().parseFromString(response.data);\n        return true;\n    }).catch(function (error) {\n        alert(\"ERROR\");\n        return false;\n    });\n\n}\n\n\nexport async function get(username, password, server, db, layout, query = null) {\n    const authHeader = 'Basic ' + base64.encode(`${username}:${password}`);\n    var XMLParser = require('react-xml-parser');\n    let url = \"https://\" + server + \"/fmi/xml/fmresultset.xml?-findall&-db=\" + db + \"&-lay=\" + layout;\n\n    if (query) {\n        url = \"https://\" + server + \"/fmi/xml/fmresultset.xml?-find&-db=\" + db + \"&-lay=\" + layout + query;\n    }\n    console.log(url);\n    let errorAuth = false;\n\n    await axios.post(url, {}, {\n        headers: { 'Authorization': authHeader }\n    }).then(function (response) {\n        data = new XMLParser().parseFromString(response.data);\n\n    }).catch(function (error) {\n        // alert(\"No connexion!\");\n        errorAuth = true;\n    });\n\n    if (errorAuth) {\n        return -1;\n    }\n\n    let fmResultSet = getFmResultSet(data);\n    let error = getError(fmResultSet);\n    let records = getRecords(fmResultSet);\n    let dataFormated = formatData(records);\n\n    return dataFormated;\n}\n"]},"metadata":{},"sourceType":"module"}